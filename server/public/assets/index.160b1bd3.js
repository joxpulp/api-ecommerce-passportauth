import{r as e,R as t,i as a,u as r,m as n,d as l,S as s,a as o,b as c,c as i,H as m}from"./vendor.ed8a5af5.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const u=(t,a)=>{const[r,n]=e.exports.useState({data:[],fetched:!1}),[l,s]=e.exports.useState(!1);return e.exports.useEffect((()=>{t&&(async()=>{try{s(!0);const e=await fetch(t,a),r=await e.json();200===e.status?(n({data:r,fetched:!0}),s(!1)):(n({data:r,fetched:!1}),s(!1))}catch(e){throw console.log(e.message),s(!1),n({fetched:!1}),e}})()}),[t]),{data:r,setData:n,loading:l,setLoading:s}},d=e.exports.createContext();function p({children:a}){const[r,n]=e.exports.useState({}),[l,s]=e.exports.useState({}),[o,c]=e.exports.useState([]),[i,m]=e.exports.useState([]),[p,g]=e.exports.useState(!1),[h,f]=e.exports.useState(!1),[E,x]=e.exports.useState(!1),[y,b]=e.exports.useState(!0),[v,N]=e.exports.useState(!1),S="https://desafio27.herokuapp.com",{data:L,setData:C,loading:w}=u(h&&`${S}/api/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r),credentials:"include"}),{data:k,loading:F}=u(E&&`${S}/api/auth/signup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l),credentials:"include"}),{data:D,setData:M}=u(y&&`${S}/api/auth/islogged`,{credentials:"include"}),{data:P}=u(v&&`${S}/api/auth/logout`,{credentials:"include"});return t.createElement(d.Provider,{value:{userLogin:r,setUserLogin:n,products:o,setProducts:c,messages:i,setMessages:m,logoutMessage:p,setLogoutMessage:g,loginData:L,setLoginData:C,loadingLogin:w,signupData:k,loadingSignup:F,loggedData:D,setLoggedData:M,loggout:P,userSignup:l,setUserSignup:s,fetchLogin:h,setFetchLogin:f,fetchIsLogged:y,setFetchIsLogged:b,fetchLogout:v,setFetchLogout:N,fetchSignup:E,setFetchSignup:x}},a)}const g=a("https://ecommerceapicoder.herokuapp.com/",{transports:["websocket"]});function h(){const[a,l]=e.exports.useState(""),[s,o]=e.exports.useState(""),{setUserLogin:c,setFetchLogin:i,logoutMessage:m,setLogoutMessage:u,fetchLogin:p,loginData:g,loadingLogin:h}=e.exports.useContext(d),f=r();return e.exports.useEffect((()=>{i(!1)}),[p]),e.exports.useEffect((()=>{setTimeout((()=>{u(!1)}),2e3)}),[m]),t.createElement(n.form,{id:"form",onSubmit:e=>{e.preventDefault(),c({username:a,password:s}),i(!0),f.push("/")}},m?t.createElement(n.div,{initial:{opacity:0,y:"-100%"},animate:{opacity:1,y:0},exit:{opacity:0,y:"-100%"},className:"container alert alert-info text-center",role:"alert"},"Hasta luego ",a):t.createElement(t.Fragment,null,g.data.error&&!h&&t.createElement(n.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,y:"-100%"},className:"container alert alert-danger text-center",role:"alert"},g.data.error),t.createElement("h2",{className:"text-center mb-4 text-light"},"Login de usuario"),t.createElement("div",{className:"d-flex justify-content-center"},t.createElement("a",{className:"btn btn-primary",href:"https://desafio27.herokuapp.com/api/auth/facebook-login"},"Ingresar con FB"))))}function f(){const[a,r]=e.exports.useState(""),[n,l]=e.exports.useState(""),[s,o]=e.exports.useState("");return t.createElement("form",{id:"form",onSubmit:e=>{e.preventDefault(),g.emit("addProduct",{title:a,price:n,thumbnail:s}),r(""),l(""),o("")}},t.createElement("h2",{className:"text-center mb-4 text-light"},"Ingrese producto"),t.createElement("div",{className:"form-floating mb-3"},t.createElement("input",{type:"text",className:"form-control",id:"title",name:"title",placeholder:"title",value:a,onChange:e=>r(e.target.value),required:!0}),t.createElement("label",{htmlFor:"title"},"Username")),t.createElement("div",{className:"form-floating mb-3"},t.createElement("input",{type:"number",min:"100",max:"5000",className:"form-control",id:"price",name:"price",placeholder:"price",value:n,onChange:e=>l(e.target.value),required:!0}),t.createElement("label",{htmlFor:"price"},"Precio")),t.createElement("div",{className:"form-floating mb-3"},t.createElement("input",{type:"text",className:"form-control",id:"thumbnail",name:"thumbnail",placeholder:"thumbnail",value:s,onChange:e=>o(e.target.value),required:!0}),t.createElement("label",{htmlFor:"thumbnail"},"URL de la imagen")),t.createElement("button",{className:"btn btn-success",type:"submit"},"Ingresar producto"))}function E(){const[a,r]=e.exports.useState(""),[s,o]=e.exports.useState(""),{messages:c}=e.exports.useContext(d),i=e.exports.useRef(null),m=e=>{e.preventDefault(),g.emit("sendMessage",{email:a,message:s,date:l().format("DD/MM/YYYY"),time:l().format("HH:mm:ss")}),o(""),i.current.scrollTop=i.current.scrollHeight};return t.createElement("div",{className:"container"},t.createElement("h2",{className:"text-center mb-4 text-light"},"Centro de Mensajes"),t.createElement("form",{onSubmit:m},t.createElement("div",{className:"container d-flex justify-content-center"},t.createElement("div",{className:"form-floating"},t.createElement("input",{type:"email",className:"form-control",id:"email",name:"email",placeholder:"email",value:a,onChange:e=>r(e.target.value),required:!0}),t.createElement("label",{htmlFor:"email"},"Correo Electronico"))),t.createElement("hr",{style:{backgroundColor:"white"}}),t.createElement("div",{style:{width:"80%",height:"400px",borderRadius:"5px",overflowY:"scroll",overflowX:"hidden"},className:"container bg-light p-3",ref:i},c.map(((e,a)=>t.createElement(n.div,{initial:{opacity:0,x:"-100%"},animate:{opacity:1,x:0},className:"container d-flex flex-column flex-lg-row",key:a},t.createElement("p",{className:"me-2 text-primary"},e.email),t.createElement("p",{className:"me-2 text-danger"},"[",e.date," ",e.time,"]:"),t.createElement("p",{className:"me-2 text-success"},e.message),t.createElement("hr",{style:{backgroundColor:"black"}}))))),t.createElement("div",{style:{width:"80%"},className:"form-floating mx-auto my-2 d-flex"},t.createElement("input",{type:"text",className:"form-control",id:"message",name:"message",placeholder:"message",value:s,disabled:!/^[\a-z0-9._-]+@{1}[\\a-z0-9.]+\.[a-z]{2,3}$/.test(a),onChange:e=>o(e.target.value),onKeyUp:e=>"Enter"===e.key&&m(),required:!0}),t.createElement("label",{htmlFor:"message"},"Mensaje"),t.createElement("button",{className:"btn btn-success ms-2",disabled:!/^[\a-z0-9._-]+@{1}[\\a-z0-9.]+\.[a-z]{2,3}$/.test(a),type:"submit"},"Enviar"))))}function x(){const{products:a}=e.exports.useContext(d);return t.createElement("div",{className:"container"},0!==a.length?t.createElement(n.div,{initial:{opacity:0},animate:{opacity:1}},t.createElement("h2",{className:"text-center mb-4 text-light"},"Vista de productos"),t.createElement("table",{className:"table table-dark"},t.createElement("thead",null,t.createElement("tr",null,t.createElement("th",{scope:"col"},"Producto"),t.createElement("th",{scope:"col"},"Precio"),t.createElement("th",{scope:"col"},"Foto"))),a.map(((e,a)=>t.createElement(n.tbody,{initial:{opacity:0,x:"-100%"},animate:{opacity:1,x:0},key:a},t.createElement("tr",null,t.createElement("td",null,e.title),t.createElement("td",null,e.price),t.createElement("td",null,t.createElement("img",{style:{width:"50px",height:"auto"},src:e.thumbnail,alt:"products"})))))))):t.createElement("div",{className:"alert alert-info text-center",role:"alert"},"No hay productos disponibles, agrega uno en el formulario de arriba"))}const y=({socket:a})=>{const{userLogin:n,setLogoutMessage:l,setFetchLogout:s,setLoginData:o,setLoggedData:c,loggedData:i}=e.exports.useContext(d);r();return t.createElement(t.Fragment,null,t.createElement("div",{className:"container alert alert-success text-center",role:"alert"},t.createElement("div",null,t.createElement("h2",null,"Bienvenido ",n.username||i.data.user.displayName),t.createElement("h4",null,i.data.user.emails[0].value),t.createElement("img",{src:i.data.user.photos[0].value,alt:""})),t.createElement("button",{className:"btn btn-warning my-2",onClick:()=>{l(!0),s(!0),o({data:{logged:!1}}),c({data:{logged:!1}})}},"Salir")),t.createElement(f,{socket:a}),t.createElement("hr",{style:{backgroundColor:"white",width:"80%"}}),t.createElement(x,{socket:a}),t.createElement("hr",{style:{backgroundColor:"white",width:"80%"}}),t.createElement(E,{socket:a}))},b=()=>{const[a,l]=e.exports.useState(""),[s,o]=e.exports.useState(""),[c,i]=e.exports.useState(""),[m,u]=e.exports.useState(""),[p,g]=e.exports.useState(""),{setUserSignup:h,signupData:f,fetchSignup:E,setFetchSignup:x,loadingSignup:y}=e.exports.useContext(d),b=r();return e.exports.useEffect((()=>{x(!1)}),[E]),t.createElement("form",{id:"form",onSubmit:e=>{e.preventDefault(),h({username:a,password:s,name:c,lastname:m,email:p}),x(!0)}},t.createElement("h2",{className:"text-center mb-4 text-light"},"Registrate"),f.data.error&&!y&&t.createElement(n.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,y:"-100%"},className:"container alert alert-danger text-center",role:"alert"},f.data.error),f.data.msg&&!y&&t.createElement(n.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,y:"-100%"},className:"container alert alert-success text-center",role:"alert"},"Usuario creado,"," ",t.createElement("a",{className:"alert-link",href:"/login"},"Iniciar sesion")),t.createElement("div",{className:"form-floating mb-3"},t.createElement("input",{type:"text",className:"form-control",id:"username",name:"username",placeholder:"username",value:a,onChange:e=>l(e.target.value),required:!0}),t.createElement("label",{htmlFor:"username"},"Username")),t.createElement("div",{className:"form-floating mb-3"},t.createElement("input",{type:"password",className:"form-control",id:"password",name:"password",placeholder:"password",value:s,onChange:e=>o(e.target.value),required:!0}),t.createElement("label",{htmlFor:"password"},"Contrasena")),t.createElement("div",{className:"form-floating mb-3"},t.createElement("input",{type:"text",className:"form-control",id:"name",name:"name",placeholder:"name",value:c,onChange:e=>i(e.target.value),required:!0}),t.createElement("label",{htmlFor:"name"},"Nombre")),t.createElement("div",{className:"form-floating mb-3"},t.createElement("input",{type:"text",className:"form-control",id:"lastname",name:"lastname",placeholder:"lastname",value:m,onChange:e=>u(e.target.value),required:!0}),t.createElement("label",{htmlFor:"lastname"},"Apellido")),t.createElement("div",{className:"form-floating mb-3"},t.createElement("input",{type:"text",className:"form-control",id:"email",name:"email",placeholder:"email",value:p,onChange:e=>g(e.target.value),required:!0}),t.createElement("label",{htmlFor:"email"},"Email")),t.createElement("button",{className:"btn btn-success me-2",type:"submit"},"Registrarse"),t.createElement("button",{className:"btn btn-secondary",onClick:()=>b.push("/login"),type:"button"},"Volver al login"))};function v(){const{loginData:a,products:r,setProducts:l,messages:i,setMessages:m,loggedData:u,setFetchIsLogged:p}=e.exports.useContext(d),f=a.data.logged||u.data.logged;return console.log(f),e.exports.useEffect((()=>{p(!0)}),[]),e.exports.useEffect((()=>(g.on("products",(e=>{l(e)})),()=>{g.off("products")})),[r]),e.exports.useEffect((()=>(g.on("messages",(e=>{m(e)})),()=>{g.off("messages")})),[i]),t.createElement(n.div,{style:{height:"100%"},className:"d-flex flex-column\n\t\t\tjustify-content-center align-items-center",initial:{opacity:0},animate:{opacity:1}},t.createElement(n.h1,{initial:{opacity:0,y:"-100%"},animate:{opacity:1,y:0,transition:{delay:.2}},className:"text-center my-4 text-light"},"Bienvenido a la API de Productos"),t.createElement("hr",{style:{backgroundColor:"white",width:"80%"}}),t.createElement(s,null,t.createElement(o,{exact:!0,path:"/login"},f?t.createElement(c,{to:"/"}):t.createElement(h,null)),t.createElement(o,{path:"/signup"},f?t.createElement(c,{to:"/"}):t.createElement(b,null)),t.createElement(o,{exact:!0,path:"/"},f?t.createElement(y,null):t.createElement(c,{to:"/login"}))))}i.render(t.createElement(t.StrictMode,null,t.createElement(p,null,t.createElement(m,null,t.createElement(v,null)))),document.getElementById("root"));
